<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Templated Workflows â€¢ onbrand</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Templated Workflows">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">onbrand</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-chalkboard-teacher"></span> Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials">
<li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/Custom_Office_Templates.html">Custom Office Templates</a></li>
    <li><a class="dropdown-item" href="../articles/Creating_Templated_Office_Workflows.html">Templated Reporting Workflows in PowerPoint and Word</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fas fa-hat-wizard"></span> Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fas fa-rss"></span> News</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/john-harrold/onbrand/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">



<link href="Creating_Templated_Office_Workflows_files/tabwid-1.1.3/tabwid.css" rel="stylesheet">
<script src="Creating_Templated_Office_Workflows_files/tabwid-1.1.3/tabwid.js"></script><div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Templated Workflows</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/john-harrold/onbrand/blob/HEAD/vignettes/Creating_Templated_Office_Workflows.Rmd" class="external-link"><code>vignettes/Creating_Templated_Office_Workflows.Rmd</code></a></small>
      <div class="d-none name"><code>Creating_Templated_Office_Workflows.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>officer</code> package is used to generate all of the
underlying PowerPoint and Word documents. The purpose of
<code>onbrand</code> is to provide an abstraction layer (or mapping) for
the functions in <code>officer</code> in order to allow the same
reporting workflow to be used with different template documents. This
involves providing a consistent customizable method to interact with
templates as well as a form of markdown to control the formatting of
text.</p>
<p>If you want to use your own Office templates, we recommend you see
the <em>Custom Office Templates Vignette</em>. This vignette focuses on
how to construct workflows using templates. Here we will use the
internal templates embedded in <code>onbrand</code>. If you want to copy
them locally you can use the following commands:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"onbrand"</span>, <span class="st">"templates"</span>, <span class="st">"report.pptx"</span><span class="op">)</span>, <span class="st">"report.pptx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"onbrand"</span>, <span class="st">"templates"</span>, <span class="st">"report.docx"</span><span class="op">)</span>, <span class="st">"report.docx"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/files.html" class="external-link">file.copy</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"onbrand"</span>, <span class="st">"templates"</span>, <span class="st">"report.yaml"</span><span class="op">)</span>, <span class="st">"report.yaml"</span><span class="op">)</span></span></code></pre></div>
<div class="section level3">
<h3 id="powerpoint">PowerPoint<a class="anchor" aria-label="anchor" href="#powerpoint"></a>
</h3>
<div class="section level4">
<h4 id="loading-your-presentation-template">Loading your presentation template<a class="anchor" aria-label="anchor" href="#loading-your-presentation-template"></a>
</h4>
<p>To create a new <code>onbrand</code> object for a PowerPoint document
you need to use <code><a href="../reference/read_template.html">onbrand::read_template()</a></code>. This requires
that you supply the path to your PowerPoint document and the
<code>yaml</code> mapping files as follows:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/read_template.html">read_template</a></span><span class="op">(</span></span>
<span>       template <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"onbrand"</span><span class="op">)</span>, <span class="st">"templates"</span>, <span class="st">"report.pptx"</span><span class="op">)</span>,</span>
<span>       mapping  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"onbrand"</span><span class="op">)</span>, <span class="st">"templates"</span>, <span class="st">"report.yaml"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="adding-content-to-placeholders">Adding content to placeholders<a class="anchor" aria-label="anchor" href="#adding-content-to-placeholders"></a>
</h4>
<p>The mapping file (printed at the bottom of this document) uses
descriptive names for slide masters and placeholders. Here is a snippet
from our report <code>yaml</code>.</p>
<pre><code>rpptx:
  master: Office Theme
  templates:
    title_slide:
      title:
        ph_label:     Title 1
        content_type: text
      sub_title:
        ph_label:     Subtitle 2
        content_type: text</code></pre>
<p>To add content, use <code><a href="../reference/report_add_slide.html">onbrand::report_add_slide()</a></code>. The
following will add a slide using the templated <code>title_slide</code>
layout. Provide the <code>elements</code> argument with a list of
placeholder names - each containing a list of values for both
<code>content</code> and <code>type</code>. For each placeholder name
listed you need to specify the content and the type of content in its
own list:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_slide.html">report_add_slide</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  template <span class="op">=</span> <span class="st">"title_slide"</span>,</span>
<span>  elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     title     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content <span class="op">=</span> <span class="st">"Onbrand PowerPoint Example"</span>,</span>
<span>                       type    <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span>,</span>
<span>     sub_title <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content <span class="op">=</span> <span class="st">"Workflow Abstraction"</span>,</span>
<span>                       type    <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>For a detailed description of the different types of content and the
expected format see the help for the
<code><a href="../reference/add_pptx_ph_content.html">onbrand::add_pptx_ph_content()</a></code> function. Briefly, you can
specify the following content types:</p>
<ul>
<li>
<code>"text"</code> - a string of text (only possible when the type
in the mapping file is <em>text</em>)</li>
<li>
<code>"list"</code> - list of information (only possible when the
type in the mapping file is <em>list</em>)</li>
<li>
<code>"imagefile"</code> - string containing the path to an image
file</li>
<li>
<code>"ggplot"</code> - a ggplot object</li>
<li>
<code>"table"</code> - list containing table content and other
options</li>
<li>
<code>"flextable"</code> - list containing flextable content and
other options</li>
<li>
<code>"flextable_object"</code> - user-defined flextable object</li>
</ul>
<div class="section level5">
<h5 id="lists">Lists<a class="anchor" aria-label="anchor" href="#lists"></a>
</h5>
<p>The previous example showed how to add text content. To add a list,
define a vector with paired content of the format
<code>c("indent level", "content", "indent level", "content)</code>.
Where <code>indent level</code> indicates a numeric value starting at 1.
For example, we could define the following list content:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">bl</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"This is first level bullet"</span>,</span>
<span>       <span class="st">"2"</span>, <span class="st">"sub-bullet"</span>,</span>
<span>       <span class="st">"3"</span>, <span class="st">"sub-sub-bullet"</span>,</span>
<span>       <span class="st">"3"</span>, <span class="st">"can't have just one sub-sub-bullet"</span>,</span>
<span>       <span class="st">"2"</span>, <span class="st">"same goes for sub-bullets"</span>,</span>
<span>       <span class="st">"1"</span>, <span class="st">"Another first level bullet"</span><span class="op">)</span></span></code></pre></div>
<p>The list <code>bl</code> can then be added to the <em>content</em>
value of any placeholder with <code>list</code> as the type in the
mapping file:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_slide.html">report_add_slide</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  template <span class="op">=</span> <span class="st">"content_list"</span>,</span>
<span>  elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     title        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content <span class="op">=</span> <span class="st">"Adding List Content"</span>,</span>
<span>                          type    <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span>,</span>
<span>     content_body <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content <span class="op">=</span> <span class="va">bl</span>,</span>
<span>                          type    <span class="op">=</span> <span class="st">"list"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="figures">Figures<a class="anchor" aria-label="anchor" href="#figures"></a>
</h5>
<p>Figures can be added in two ways:</p>
<ol style="list-style-type: decimal">
<li>as an image file (e.g.Â a png)<br>
</li>
<li>as a ggplot object (<em>preferred method</em>)</li>
</ol>
<p>Generally, the ggplot object is preferred as it will automatically
size according to the dimensions of the placeholder. First lets create
some images:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x<span class="op">=</span><span class="fl">0</span>, y<span class="op">=</span><span class="fl">0</span>, label <span class="op">=</span> <span class="st">"picture example"</span><span class="op">)</span></span>
<span><span class="va">imgfile</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"image"</span>, fileext<span class="op">=</span><span class="st">".png"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span>filename<span class="op">=</span><span class="va">imgfile</span>, plot<span class="op">=</span><span class="va">p</span>, height<span class="op">=</span><span class="fl">5.15</span>, width<span class="op">=</span><span class="fl">9</span>, units<span class="op">=</span><span class="st">"in"</span><span class="op">)</span></span></code></pre></div>
<p>Now that the object <code>p</code> contains the ggplot object and
<code>imgfile</code> points to a png file containing that image, we can
add the content to our <code>two_content_header_text</code> slide
template:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_slide.html">report_add_slide</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  template <span class="op">=</span> <span class="st">"two_content_header_text"</span>,</span>
<span>  elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     title                <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>content  <span class="op">=</span> <span class="st">"Adding Images Content"</span>,</span>
<span>                                 type     <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span>,</span>
<span>     content_left_header  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>content  <span class="op">=</span><span class="st">"ggplot object"</span>,</span>
<span>                                 type     <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span>,</span>
<span>     content_left         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>content  <span class="op">=</span> <span class="va">p</span>,</span>
<span>                                 type     <span class="op">=</span> <span class="st">"ggplot"</span><span class="op">)</span>,</span>
<span>     content_right_header <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>content  <span class="op">=</span><span class="st">"image file"</span>,</span>
<span>                                 type     <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span>,</span>
<span>     content_right        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>content  <span class="op">=</span> <span class="va">imgfile</span>,</span>
<span>                                 type     <span class="op">=</span> <span class="st">"imagefile"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level5">
<h5 id="tables">Tables<a class="anchor" aria-label="anchor" href="#tables"></a>
</h5>
<p>Tables can be supplied in three different ways, each providing
increasing level of control over the output:</p>
<ul>
<li>
<code>table</code> - Expects a list with the tabular data and other
attributes. It uses the underlying tables in PowerPoint to make the
tables.</li>
<li>
<code>flextable</code> - Expects a list similar to the
<code>table</code> above, but instead of using the PowerPoint tables,
the table is created using the <code>flextable</code> package.</li>
<li>
<code>flextable_object</code> - This allows you to create a
flextable on your own and use it directly. The ultimate level of
control.</li>
</ul>
<p>Lets start by creating a simple data frame:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tdf</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Length"</span>, <span class="st">"Width"</span>, <span class="st">"Height"</span><span class="op">)</span>,</span>
<span>                 Values     <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>                 Units      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"m"</span>, <span class="st">"m"</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p>To create a PowerPoint table, use the <code>table</code> content
type. Construct a named list with a single element, <code>table</code>,
containing the data frame; <code>tab_cont = list(table = tdf)</code>.
You can add list elements to display header information as well. See the
help for <code><a href="../reference/add_pptx_ph_content.html">onbrand::add_pptx_ph_content()</a></code> for details.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_cont</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>table <span class="op">=</span> <span class="va">tdf</span><span class="op">)</span></span>
<span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_slide.html">report_add_slide</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  template <span class="op">=</span> <span class="st">"content_text"</span>, </span>
<span>  elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     title         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content      <span class="op">=</span> <span class="st">"Tables"</span>,</span>
<span>                           type         <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span>,</span>
<span>     sub_title     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content      <span class="op">=</span> <span class="st">"Creating PowerPoint Table"</span>,</span>
<span>                           type         <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span>,</span>
<span>     content_body  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content      <span class="op">=</span> <span class="va">tab_cont</span>,</span>
<span>                           type         <span class="op">=</span> <span class="st">"table"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Sometimes you may want to have a little more control over the tabular
output. The <code>flextable</code> type allows you to supply the data
and information about the flextable to be created and
<code>onbrand</code> will then use them to create the flextable for
you.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_ft</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>table         <span class="op">=</span> <span class="va">tdf</span>,</span>
<span>              header_format <span class="op">=</span> <span class="st">"md"</span>,</span>
<span>              header_top    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Parameters <span class="op">=</span> <span class="st">"Name^2^"</span>,</span>
<span>                                   Values     <span class="op">=</span> <span class="st">"*Value*"</span>,</span>
<span>                                   Units      <span class="op">=</span> <span class="st">"**Units**"</span><span class="op">)</span>,</span>
<span>              cwidth        <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>              table_autofit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              table_theme   <span class="op">=</span> <span class="st">"theme_zebra"</span><span class="op">)</span></span></code></pre></div>
<p>Here we are specifying that we want the header format of the table to
be rendered as markdown <code>"md"</code> and we are specifying that the
top header (there can be top, middle and bottom) should be overwritten
(for more on formatting with markdown see the markdown section below).
Next we specify some other details like the column width. Again
reference the help for <code><a href="../reference/add_pptx_ph_content.html">onbrand::add_pptx_ph_content()</a></code>. It
covers the details of the list elements that can be supplied.</p>
<p>Alternatively, you can create a flextable object directly using the
<code>flextable</code> package. There is an enormous amount of
flexibility in the <code>flextable</code> package. Some of these can be
seen in the Word examples below, but you should see the documentation
for that package to get a feel for what is possible.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_fto</span> <span class="op">=</span> <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html" class="external-link">flextable</a></span><span class="op">(</span><span class="va">tdf</span><span class="op">)</span>                      </span></code></pre></div>
<p>You can then add these (flextable list: <code>tab_ft</code>,
flextable object: <code>tab_fto</code>) to any of the placeholders on a
slide:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_slide.html">report_add_slide</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  template <span class="op">=</span> <span class="st">"two_content_header_text"</span>,</span>
<span>  elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     title                 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content      <span class="op">=</span> <span class="st">"Tables"</span>,</span>
<span>                                   type         <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span>,</span>
<span>     sub_title             <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content      <span class="op">=</span> <span class="st">"flextables can be created in two ways"</span>,</span>
<span>                                   type         <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span>,</span>
<span>     content_left_header   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content      <span class="op">=</span> <span class="st">'using "flextable"'</span>,</span>
<span>                                   type         <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span>,</span>
<span>     content_left          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content      <span class="op">=</span> <span class="va">tab_ft</span>,</span>
<span>                                   type         <span class="op">=</span> <span class="st">"flextable"</span><span class="op">)</span>,</span>
<span>     content_right_header  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content      <span class="op">=</span> <span class="st">'using "flextable_objecct"'</span>,</span>
<span>                                   type         <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span>,</span>
<span>     content_right         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content      <span class="op">=</span> <span class="va">tab_fto</span>,</span>
<span>                                   type         <span class="op">=</span> <span class="st">"flextable_object"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="adding-content-in-user-defined-locations">Adding content in user-defined locations<a class="anchor" aria-label="anchor" href="#adding-content-in-user-defined-locations"></a>
</h4>
<p>If you want to place content in arbitrary locations on the slide you
can use the <code>user_location</code> argument to
<code><a href="../reference/report_add_slide.html">report_add_slide()</a></code>. The content and type is the same as
above. You also need to supply a start and stop point. These are x-y
coordinates as measured from the upper left point on the slide and they
define the box where the content will be inserted. They represent
fractions of the total slide width (x) and height (y):</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_slide.html">report_add_slide</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  template <span class="op">=</span> <span class="st">"two_content_header_list"</span>,</span>
<span>  elements <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     title         <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content      <span class="op">=</span> <span class="st">"Combining elements, user defined locations, and formatting"</span>,</span>
<span>                           type         <span class="op">=</span> <span class="st">"text"</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  user_location <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>     txt_example   <span class="op">=</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content        <span class="op">=</span> <span class="fu"><a href="https://davidgohel.github.io/officer/reference/fpar.html" class="external-link">fpar</a></span><span class="op">(</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/ftext.html" class="external-link">ftext</a></span><span class="op">(</span><span class="st">"This is formatted text"</span>, <span class="fu"><a href="https://davidgohel.github.io/officer/reference/fp_text.html" class="external-link">fp_text</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"green"</span>, font.size<span class="op">=</span><span class="fl">24</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             type           <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>             start          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,  <span class="fl">.25</span><span class="op">)</span>,</span>
<span>             stop           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">.35</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     large_figure  <span class="op">=</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content        <span class="op">=</span> <span class="va">p</span>,</span>
<span>             type           <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span>             start          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">.25</span><span class="op">)</span>,</span>
<span>             stop           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.99</span>,<span class="fl">.99</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     flextable_obj  <span class="op">=</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content        <span class="op">=</span> <span class="va">tab_fto</span>,</span>
<span>             type           <span class="op">=</span> <span class="st">"flextable_object"</span>,</span>
<span>             start          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">.75</span><span class="op">)</span>,</span>
<span>             stop           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">.95</span><span class="op">)</span><span class="op">)</span>,</span>
<span>     small_figure  <span class="op">=</span></span>
<span>       <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> content        <span class="op">=</span> <span class="va">p</span>,</span>
<span>             type           <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span>             start          <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,  <span class="fl">.35</span><span class="op">)</span>,</span>
<span>             stop           <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.25</span>,<span class="fl">.74</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Note that you can use both <code>elements</code> and
<code>user_location</code> together.</p>
</div>
<div class="section level4">
<h4 id="saving-presentations">Saving presentations<a class="anchor" aria-label="anchor" href="#saving-presentations"></a>
</h4>
<p>Once you are done adding content you can save the presentation to a
file:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/save_report.html">save_report</a></span><span class="op">(</span><span class="va">obnd</span>, <span class="st">"vignette_presentation.pptx"</span><span class="op">)</span></span></code></pre></div>
<p>Which should look something like this: <img src="ppt_workflow_output.png" width="600" alt="Example PowerPoint output for workflow above."></p>
</div>
<div class="section level4">
<h4 id="accessing-the-powerpoint-mapping-information">Accessing the PowerPoint mapping information<a class="anchor" aria-label="anchor" href="#accessing-the-powerpoint-mapping-information"></a>
</h4>
<p>Sometimes it can be difficult to remember the template and
placeholder names from the mapping file. You and use the
<code><a href="../reference/template_details.html">onbrand::template_details</a></code> function to show this information
for the current <code>onbrand</code> object.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">details</span> <span class="op">=</span> <span class="fu"><a href="../reference/template_details.html">template_details</a></span><span class="op">(</span><span class="va">obnd</span><span class="op">)</span> </span></code></pre></div>
<pre><code>Mapping:     /private/var/folders/pq/7srbf_fx3rd3k706hgxkg61r0000gp/T/RtmpbqJJ5c/temp_libpath78f636cc7423/onbrand/templates/report.yaml
Report Type: PowerPoint
title_slide (master/template)
  &gt; title (text)
  &gt; sub_title (text)
section_slide (master/template)
  &gt; title (text)
  &gt; sub_title (text)
title_only (master/template)
  &gt; title (text)
content_text (master/template)
  &gt; title (text)
  &gt; sub_title (text)
  &gt; content_body (text)
content_list (master/template)
  &gt; title (text)
  &gt; sub_title (text)
  &gt; content_body (list)
two_content_header_list (master/template)
  &gt; title (text)
  &gt; sub_title (text)
  &gt; content_left_header (text)
  &gt; content_left (list)
  &gt; content_right_header (text)
  &gt; content_right (list)
two_content_header_text (master/template)
  &gt; title (text)
  &gt; sub_title (text)
  &gt; content_left_header (text)
  &gt; content_left (text)
  &gt; content_right_header (text)
  &gt; content_right (text)
two_content_list (master/template)
  &gt; title (text)
  &gt; sub_title (text)
  &gt; content_left (list)
  &gt; content_right (list)
two_content_text (master/template)
  &gt; title (text)
  &gt; sub_title (text)
  &gt; content_left (text)
  &gt; content_right (text)</code></pre>
<p>If you do not want to use the interfaces above for creating slides
but would like to use the named mapping information in a more
traditional <code>officer</code> workflow you can use the function
<code>fph</code>. After youâ€™ve loaded the <code>onbrand</code> object
above (<code>obnd</code>) you can then pull out the placeholder label
from PowerPoint for any named placeholder in a template layout specified
in the yaml mapping file. For example if we wanted the placeholder label
for the <code>content_left_header</code> in the
<code>two_content_header_text</code> layout we would use the
following:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ph</span> <span class="op">=</span> <span class="fu"><a href="../reference/fph.html">fph</a></span><span class="op">(</span><span class="va">obnd</span>, <span class="st">"two_content_header_text"</span>, <span class="st">"content_left_header"</span><span class="op">)</span><span class="op">$</span><span class="va">pl</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="word">Word<a class="anchor" aria-label="anchor" href="#word"></a>
</h3>
<div class="section level4">
<h4 id="loading-your-word-template">Loading your Word template<a class="anchor" aria-label="anchor" href="#loading-your-word-template"></a>
</h4>
<p>The <code><a href="../reference/read_template.html">onbrand::read_template()</a></code> function is also used to
create a new <code>onbrand</code> object for a Word report. Just as
before, you need to supply the path to your Word template and the
mapping file. This example points to files within the
<code>onbrand</code> package:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/read_template.html">read_template</a></span><span class="op">(</span></span>
<span>  template <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"onbrand"</span><span class="op">)</span>, <span class="st">"templates"</span>, <span class="st">"report.docx"</span><span class="op">)</span>,</span>
<span>  mapping  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span>package<span class="op">=</span><span class="st">"onbrand"</span><span class="op">)</span>, <span class="st">"templates"</span>, <span class="st">"report.yaml"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="adding-content">Adding content<a class="anchor" aria-label="anchor" href="#adding-content"></a>
</h4>
<p>Word report content is added using the
<code><a href="../reference/report_add_doc_content.html">onbrand::report_add_doc_content()</a></code> function. This expects
the user to identify the <code>type</code> of content being supplied. At
a high level the following types of content can be added:</p>
<ul>
<li>
<code>"break"</code> - page break</li>
<li>
<code>"toc"</code> - table of contents</li>
<li>
<code>"ph"</code> - text content to substitute for placeholders in
the document</li>
<li>
<code>"text"</code> - text supplied as either character string,
markdown or the result of <code><a href="https://davidgohel.github.io/officer/reference/fpar.html" class="external-link">officer::fpar()</a></code> statements</li>
<li>
<code>"imagefile"</code> - string containing the path to an image
file</li>
<li>
<code>"ggplot"</code> - a ggplot object</li>
<li>
<code>"table"</code> - list containing table content and other
options</li>
<li>
<code>"flextable"</code> - list containing flextable content and
other options</li>
<li>
<code>"flextable_object"</code> - user-defined flextable object</li>
</ul>
<p>Similar to adding PowerPoint content, you must also supply a list
containing the content and information about the content. Examples of
each of these will be provided in the sections below. However you should
see the help for <code><a href="../reference/report_add_doc_content.html">onbrand::report_add_doc_content()</a></code> to get a
detailed explanation of the format of <code>content</code>.</p>
</div>
<div class="section level4">
<h4 id="table-of-contents">Table of contents<a class="anchor" aria-label="anchor" href="#table-of-contents"></a>
</h4>
<p>A table of contents, list of figures, or list of tables is added
using the content type <code>"toc"</code>. You can supply a level and/or
an <code>onbrand</code> style. If you supply a level, the TOC will be
generated down to that header level. If you supply an
<code>onbrand</code> style, the TOC will include each element with that
style. So if you wish to generate separate lists of tables and figures
it is important that your <code>onbrand</code> styles for those point to
different Word styles.</p>
<p>This will add a typical TOC:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"toc"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>level<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>While this should add the list of tables:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"toc"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>style<span class="op">=</span><span class="st">"Table_Caption"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>And this should add a list of figures:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"toc"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>style<span class="op">=</span><span class="st">"Figure_Caption"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note:</strong> If you try to update the TOCs and you get the
following:</p>
<p><strong>No table of contents entries found.</strong></p>
<p>You may need to change the separator option in the <code>yaml</code>
mapping file from: <code>,</code> to <code>;</code>.</p>
</div>
<div class="section level4">
<h4 id="text">Text<a class="anchor" aria-label="anchor" href="#text"></a>
</h4>
<p>The content type <code>"text"</code> is the most straight forward way
to add content to a Word document, and the <code>content</code> is a
list that has three possible elements. The only one required is the
<code>text</code> element. If you just want to add text in the default
format (<code>doc_def</code> in the <code>yaml</code> mapping file),
then this is all you need to do:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text<span class="op">=</span><span class="st">"Text with no style specified will use the doc_def text format. This is a 'ph' placehoder for text: ===BODY-TEXT-EXAMPLE=== [see Placeholder text section below]"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="section level5">
<h5 id="styles">Styles<a class="anchor" aria-label="anchor" href="#styles"></a>
</h5>
<p>Alternatively you can specify any style defined in the
<code>yaml</code> mapping file by adding a <code>style</code> element to
the content list. This shows how to create multi-level headers:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text  <span class="op">=</span><span class="st">"First level header"</span>,</span>
<span>                  style <span class="op">=</span> <span class="st">"Heading_1"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text  <span class="op">=</span><span class="st">"Second level header"</span>,</span>
<span>                  style <span class="op">=</span> <span class="st">"Heading_2"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text  <span class="op">=</span><span class="st">"Third level header"</span>,</span>
<span>                  style <span class="op">=</span> <span class="st">"Heading_3"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note:</strong> If you want to use table and figure caption
numbers that use section numbers (e.g.Â 1-1, 1-2, etc.) you may want/need
to reset the figure counter for each major section. To do this you will
need to use the <code>fig_start_at</code> and <code>tab_start_at</code>
arguments to reset the counters for that section.</p>
</div>
<div class="section level5">
<h5 id="formats">Formats<a class="anchor" aria-label="anchor" href="#formats"></a>
</h5>
<p>The other element you may want to control is the format of the
content. In the previous examples you just needed to provide character
data, but there are three possible formats you can use:</p>
<ul>
<li>
<code>"text"</code> - character string (previous examples)</li>
<li>
<code>"md"</code> - character string with markdown to be rendered
(see the section on markdown below)</li>
<li>
<code>"fpar"</code> - <code><a href="https://davidgohel.github.io/officer/reference/fpar.html" class="external-link">officer::fpar()</a></code> object from
<code>officer</code> (used with paragraph text)</li>
<li>
<code>"ftext"</code> - list of <code><a href="https://davidgohel.github.io/officer/reference/ftext.html" class="external-link">officer::ftext()</a></code> objects
<code>officer</code> (used with captions and notes for figures and
tables)</li>
</ul>
<p>The following provide example <code>"fpar"</code> and
<code>"md"</code> formats</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ardata-fr.github.io/officeverse/" class="external-link">officer</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">fpartext</span> <span class="op">=</span> <span class="fu"><a href="https://davidgohel.github.io/officer/reference/fpar.html" class="external-link">fpar</a></span><span class="op">(</span></span>
<span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/ftext.html" class="external-link">ftext</a></span><span class="op">(</span><span class="st">"Formatted text can be created using the "</span>, prop<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/ftext.html" class="external-link">ftext</a></span><span class="op">(</span><span class="st">"fpar "</span>, prop<span class="op">=</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/fp_text.html" class="external-link">fp_text</a></span><span class="op">(</span>color<span class="op">=</span><span class="st">"green"</span><span class="op">)</span><span class="op">)</span>,</span>
<span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/ftext.html" class="external-link">ftext</a></span><span class="op">(</span><span class="st">"command from the officer package."</span>, prop<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text   <span class="op">=</span> <span class="va">fpartext</span>, </span>
<span>                  format <span class="op">=</span> <span class="st">"fpar"</span>,</span>
<span>                  style  <span class="op">=</span> <span class="st">"Normal"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">mdtext</span> <span class="op">=</span> <span class="st">"Formatted text can be created using **&lt;color:green&gt;markdown&lt;/color&gt;** formatting"</span></span>
<span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text   <span class="op">=</span> <span class="va">mdtext</span>,</span>
<span>                  format <span class="op">=</span> <span class="st">"md"</span>,</span>
<span>                  style  <span class="op">=</span> <span class="st">"Normal"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level4">
<h4 id="figures-1">Figures<a class="anchor" aria-label="anchor" href="#figures-1"></a>
</h4>
<p>Similar to the PowerPoint example above weâ€™re going to create some
figures. Both an image file (<code>imgfile</code>) and a ggplot object
(<code>p</code>):</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/annotate.html" class="external-link">annotate</a></span><span class="op">(</span><span class="st">"text"</span>, x<span class="op">=</span><span class="fl">0</span>, y<span class="op">=</span><span class="fl">0</span>, label <span class="op">=</span> <span class="st">"picture example"</span><span class="op">)</span></span>
<span><span class="va">imgfile</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"image"</span>, fileext<span class="op">=</span><span class="st">".png"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html" class="external-link">ggsave</a></span><span class="op">(</span>filename<span class="op">=</span><span class="va">imgfile</span>, plot<span class="op">=</span><span class="va">p</span>, height<span class="op">=</span><span class="fl">5.15</span>, width<span class="op">=</span><span class="fl">9</span>, units<span class="op">=</span><span class="st">"in"</span><span class="op">)</span></span></code></pre></div>
<p>We can add these by specifying the appropriate content type. The
content list can contain different information. Typically you would
either specify the image file or ggplot object as well as a caption:</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"imagefile"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>image   <span class="op">=</span> <span class="va">imgfile</span>,</span>
<span>                  caption <span class="op">=</span> <span class="st">"This is an example of an image from a file."</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>image   <span class="op">=</span> <span class="va">p</span>,</span>
<span>                  caption <span class="op">=</span> <span class="st">"This is an example of an image from a ggplot object."</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="tables-1">Tables<a class="anchor" aria-label="anchor" href="#tables-1"></a>
</h4>
<p>Tables in Word are similar to the tables in PowerPoint. The table
type can be either <code>table</code>, <code>flextable</code>, or
<code>flextable_object</code>. Lets look at this data frame to see how
to use each of these:</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tdf</span> <span class="op">=</span>    <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>Parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Length"</span>, <span class="st">"Width"</span>, <span class="st">"Height"</span><span class="op">)</span>,</span>
<span>                    Values     <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,</span>
<span>                    Units      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"m"</span>, <span class="st">"m"</span>, <span class="st">"m"</span><span class="op">)</span> <span class="op">)</span></span></code></pre></div>
<p>To insert a native Word table, you would use the <code>table</code>
type and the content is just a list with an element named
<code>table</code> that has the value of a dataframe. As with figures,
the content list can have an optional caption as well.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_cont</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>table   <span class="op">=</span> <span class="va">tdf</span>,</span>
<span>                caption <span class="op">=</span> <span class="st">"Word Table."</span><span class="op">)</span></span>
<span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"table"</span>,</span>
<span>  content  <span class="op">=</span> <span class="va">tab_cont</span><span class="op">)</span></span></code></pre></div>
<p>Flextables can be used with the <code>flextable</code> type and
information like headers, header formatting, etc can be passed along.
<code>onbrand</code> will then construct the flextable for you.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_ft</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>table         <span class="op">=</span> <span class="va">tdf</span>,</span>
<span>              header_format <span class="op">=</span> <span class="st">"md"</span>,</span>
<span>              header_top    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>Parameters <span class="op">=</span> <span class="st">"Name^2^"</span>,</span>
<span>                                   Values     <span class="op">=</span> <span class="st">"*Value*"</span>,</span>
<span>                                   Units      <span class="op">=</span> <span class="st">"**Units**"</span><span class="op">)</span>,</span>
<span>              cwidth        <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>              table_autofit <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>              caption       <span class="op">=</span> <span class="st">"Flextable from onbrand abstraction"</span>,</span>
<span>              table_theme   <span class="op">=</span> <span class="st">"theme_zebra"</span><span class="op">)</span></span>
<span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"flextable"</span>,</span>
<span>  content  <span class="op">=</span> <span class="va">tab_ft</span><span class="op">)</span>   </span></code></pre></div>
<p>Lastly, to have the most control over the table you can construct a
flextable yourself and pass that along in the content.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab_fto</span> <span class="op">=</span> <span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html" class="external-link">flextable</a></span><span class="op">(</span><span class="va">tdf</span><span class="op">)</span>                      </span>
<span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"flextable_object"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ft<span class="op">=</span><span class="va">tab_fto</span>,</span>
<span>                  caption  <span class="op">=</span> <span class="st">"Flextable object created by the user."</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="formatting-sections">Formatting sections<a class="anchor" aria-label="anchor" href="#formatting-sections"></a>
</h4>
<p>Section formatting, changing the page orientation and/or the number
of columns, is controlled using the <code>"section"</code> content type.
It may seem a bit counter intuitive but sections apply to the content
added <strong>since the last</strong> section type specification. So now
lets try the following:</p>
<ul>
<li>Add a landscape figure</li>
<li>Add two column text<br>
</li>
<li>Add more content in portrait orientation</li>
</ul>
<p>To change formatting we need to close out the current section by
inserting a portrait section type:</p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>     type     <span class="op">=</span> <span class="st">"section"</span>,</span>
<span>     content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>section_type  <span class="op">=</span><span class="st">"portrait"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Then we add the content we want in landscape mode:</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>image   <span class="op">=</span> <span class="va">p</span>,</span>
<span>                  height  <span class="op">=</span> <span class="fl">2.5</span>,</span>
<span>                  width   <span class="op">=</span> <span class="fl">9</span>,</span>
<span>                  caption <span class="op">=</span> <span class="st">"This is a landscape figure."</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now we tell the underlying report to apply landscape formatting to
everything that has been added since the portrait section type:</p>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"section"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>section_type  <span class="op">=</span><span class="st">"landscape"</span>,</span>
<span>                  height        <span class="op">=</span> <span class="fl">8</span>,</span>
<span>                  width         <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now we want to add the text for the two column format:</p>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Some two column text."</span>, <span class="fl">200</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">" "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now we insert a section indicating that we want to change the section
to multiple columns. The number of columns is inferred from the number
of elements in the <code>widths</code> argument:</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"section"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>section_type  <span class="op">=</span><span class="st">"columns"</span>,</span>
<span>                  widths        <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We can now add content but donâ€™t forget to set the insert a portrait
section at the end just before you save the document.</p>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type          <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  content       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>text    <span class="op">=</span> <span class="st">"Back to regular portrait"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="placeholder-text">Placeholder text<a class="anchor" aria-label="anchor" href="#placeholder-text"></a>
</h4>
<p>When generating reporting workflows it can be helpful to have
placeholder text in the report that is populated based on the specifics
of that report. To add placeholders you can use the <code>"ph"</code>
content type. This content type will not appear in the <code>yaml</code>
file, it is unique to <code>onbrand</code>. A placeholder is a unique
string of text surrounded on both sides by <code>===</code> (<em>three
equal signs</em>). If the placeholder is in your template document, it
may not work correctly if you type the text into Word. This is because
while a string may appear to be a contiguous in Word, it may not be so
in the underlying XML code. To ensure the string is contiguous you
should type the placeholder text into a text editor, then copy and paste
it into the Word template.</p>
<p>The placeholder can be in the document template itself (in the footer
or header sections) or in the text you generate and add as part of your
workflow. In this example, the text <code>===BODY-TEXT-EXAMPLE===</code>
was added into the text content we added in the first step above. That
placeholder will be replaced with the text
<code>Swaps the placeholder with this Text</code>.</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"ph"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name     <span class="op">=</span> <span class="st">"BODY-TEXT-EXAMPLE"</span>,</span>
<span>                  value    <span class="op">=</span> <span class="st">"Swaps the placeholder with this Text"</span>,</span>
<span>                  location <span class="op">=</span> <span class="st">"body"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>You can have the placeholders in the body as in the previous example
and also in the headers and footers of the document. Again, these will
not appear in the <code>yaml</code> mapping (or abstraction layer). In
these examples the <code>===FOOTERLEFT===</code> and
<code>===HEADERLEFT===</code> placeholders are found in the template
itself. There is another placeholder <code>===HEADERRIGHT===</code>
which we have not used so that you can see it in the final output.</p>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"ph"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name     <span class="op">=</span> <span class="st">"FOOTERLEFT"</span>,</span>
<span>                  value    <span class="op">=</span> <span class="st">"Text Swapped with Footer Placeholder"</span>,</span>
<span>                  location <span class="op">=</span> <span class="st">"footer"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"ph"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>name     <span class="op">=</span> <span class="st">"HEADERLEFT"</span>,</span>
<span>                  value    <span class="op">=</span> <span class="st">"Text Swapped with Header Placeholder"</span>,</span>
<span>                  location <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Headers are applied when the document is saved and can be added at
any time to the <code>onbrand</code> report object.</p>
</div>
<div class="section level4">
<h4 id="formatting-sections-again">Formatting sections (again)<a class="anchor" aria-label="anchor" href="#formatting-sections-again"></a>
</h4>
<p>Recall up above that we were in a multi-column page format, but we
wanted to return to the default portrait single column format. We added
text but before we save the file we need to tell the document to apply
the new section type:</p>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"section"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>section_type  <span class="op">=</span><span class="st">"portrait"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note:</strong> that if you donâ€™t alter the page format/layout
from the document default, then you do not need to add any section
content.</p>
</div>
<div class="section level4">
<h4 id="multi-page-figures-and-tables">Multi-page figures and tables<a class="anchor" aria-label="anchor" href="#multi-page-figures-and-tables"></a>
</h4>
<p>Some figures and tables need to span multiple pages. If you have a
large <code>flextable</code> it will do that automatically. However it
may be more desirable to have a caption on each page with the figure or
table. To accomplish this, using a figure as an example you need to
create a separate figure for each page. For each figure you will need to
provide the <em>same</em> key value. The first figure with that key will
be assigned a figure number and the other figures with that key will
have the same number that references the first.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>image           <span class="op">=</span> <span class="va">p</span>,</span>
<span>                  notes_format    <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>                  key             <span class="op">=</span> <span class="st">"ex_fig_text"</span>,</span>
<span>                  notes           <span class="op">=</span> <span class="st">"This figure shows how to use text captions _and_ notes"</span>,</span>
<span>                  caption_format  <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>                  caption         <span class="op">=</span> <span class="st">"Multi-page figure (page 1)"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"break"</span>,</span>
<span>  content  <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"ggplot"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>image           <span class="op">=</span> <span class="va">p</span>,</span>
<span>                  notes_format    <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>                  key             <span class="op">=</span> <span class="st">"ex_fig_text"</span>,</span>
<span>                  notes           <span class="op">=</span> <span class="st">"This figure shows how to use text captions _and_ notes"</span>,</span>
<span>                  caption_format  <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>                  caption         <span class="op">=</span> <span class="st">"Multi-page figure (page 2)"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="cross-referencing-figures-and-tables">Cross referencing figures and tables<a class="anchor" aria-label="anchor" href="#cross-referencing-figures-and-tables"></a>
</h4>
<p>When figures and tables are created above each content list has an
optional key. In the example from the last section we created the key
<code>"ex_fig_text"</code>. To reference in the word document you have
two options. You can construct your content using onbrand markdown. Then
you simply need to use the <code>ref</code> tag:
<code>&lt;ref:ex_fig_text&gt;</code> and the figure number will be
replaced when the document is built. You can also use the
<code><a href="https://davidgohel.github.io/officer/reference/fpar.html" class="external-link">officer::fpar()</a></code> function to construct content. Then you
would use the officer command <code><a href="https://davidgohel.github.io/officer/reference/run_reference.html" class="external-link">officer::run_reference()</a></code> and
the figure key to insert the figure number.</p>
</div>
<div class="section level4">
<h4 id="saving-the-word-report">Saving the Word report<a class="anchor" aria-label="anchor" href="#saving-the-word-report"></a>
</h4>
<p>Once you are done adding content you can save the report to a file
with the `save_report()`` function as well:</p>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/save_report.html">save_report</a></span><span class="op">(</span><span class="va">obnd</span>, <span class="st">"vignette_report.docx"</span><span class="op">)</span></span></code></pre></div>
<p>The output from the example above should look like this:</p>
<div class="float">
<img src="doc_workflow_output.png" width="700" alt="Example Word output for workflow above."><div class="figcaption">Example Word output for workflow above.</div>
</div>
</div>
<div class="section level4">
<h4 id="accessing-the-word-mapping-information">Accessing the Word mapping information<a class="anchor" aria-label="anchor" href="#accessing-the-word-mapping-information"></a>
</h4>
<p>It can also be useful to quickly access the <code>onbrand</code>
style names. You can use the same <code><a href="../reference/template_details.html">onbrand::template_details</a></code>
function to display the current styles available to you:</p>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">details</span> <span class="op">=</span> <span class="fu"><a href="../reference/template_details.html">template_details</a></span><span class="op">(</span><span class="va">obnd</span><span class="op">)</span> </span></code></pre></div>
<pre><code>Mapping:     /private/var/folders/pq/7srbf_fx3rd3k706hgxkg61r0000gp/T/RtmpbqJJ5c/temp_libpath78f636cc7423/onbrand/templates/report.yaml
Report Type: Word
  onbrand style (word style, style type)
  --------------------------------------
  Code (Code, paragraph)
  Figure_Caption (graphic title, paragraph)
  Heading_1 (heading 1, paragraph)
  Heading_2 (heading 2, paragraph)
  Heading_3 (heading 3, paragraph)
  Normal (Normal, paragraph)
  Notes (Notes, paragraph)
  TOC (toc 1, paragraph)
  Table_Caption (table title, paragraph)
  Table (Table Grid, table)</code></pre>
<p>As with the PowerPoint interface, you can also access the named Word
mapping directly. This is done through the <code>fst</code> function.
With the <code>onbrand</code> objected loaded (<code>obnd</code>) you
can supply an <code>onbrand</code> style name and pull out the Word
style name (<code>wsn</code>) and the default font format
(<code>dff</code>):</p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">st</span> <span class="op">=</span> <span class="fu"><a href="../reference/fst.html">fst</a></span><span class="op">(</span><span class="va">obnd</span>, <span class="st">"Heading_3"</span><span class="op">)</span></span>
<span><span class="co">#Word style name</span></span>
<span><span class="va">wsn</span> <span class="op">=</span> <span class="va">st</span><span class="op">$</span><span class="va">wsn</span></span>
<span><span class="co"># Default font format</span></span>
<span><span class="va">dff</span> <span class="op">=</span> <span class="va">st</span><span class="op">$</span><span class="va">dff</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="formatting-with-markdown">Formatting with markdown<a class="anchor" aria-label="anchor" href="#formatting-with-markdown"></a>
</h3>
<p>In <code>officer</code> you can change formatting in text using
<code>fpar</code> and <code>as_pargraph</code>. There are situations
where this is less than ideal. For example if you want to take formatted
user input from a Shiny app, it may not be practical to have them supply
code this way.</p>
<p>To make formatting a little easier, <code>onbrand</code> provides the
ability to use markdown. This can be seen above in flextable objects for
PowerPoint content and with text, captions in Word. For a list of
allowed markdown formatting see the help for
`onbrand::md_to_officer()``.</p>
<p>If you want to use the markdown functionality outside of
<code>onbrand</code> you can use the two functions:</p>
<ul>
<li>
<code><a href="../reference/md_to_officer.html">onbrand::md_to_officer</a></code> - This function will take the
markdown text and convert that into strings of text containing officer
commands in <code>fpar</code> and <code>as_paragraph</code> commands.
You simply need to use the <code>eval</code> command to execute
them.</li>
<li>
<code><a href="../reference/md_to_oo.html">onbrand::md_to_oo</a></code> - A function that wraps around
<code>md_to_officer</code> and returns the <code>as_paragraph</code>
result.</li>
</ul>
<div class="section level4">
<h4 id="using-onbrandmd_to_oo-to-format">Using <code>onbrand::md_to_oo</code> to format<a class="anchor" aria-label="anchor" href="#using-onbrandmd_to_oo-to-format"></a>
</h4>
<p>First lets start with data. Here we have dimensional data listed as a
mean and variance:</p>
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>property <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean"</span>,   <span class="st">"variance"</span><span class="op">)</span>,</span>
<span>                  length     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">200</span>,      <span class="fl">0.13</span><span class="op">)</span>,</span>
<span>                  width      <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">12</span>,       <span class="fl">0.05</span><span class="op">)</span>,</span>
<span>                  area       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">240</span>,      <span class="fl">0.11</span><span class="op">)</span>,</span>
<span>                  volume     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1200</span>,     <span class="fl">0.32</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now lets create a flextable object with a header that shows the
property being reported on one line and the units on the line below:</p>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">header</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>property <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>,             <span class="st">""</span><span class="op">)</span>,</span>
<span>              length   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Length"</span>,       <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>              width    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Wdith"</span>,        <span class="st">"cm"</span><span class="op">)</span>,</span>
<span>              area     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Area"</span>,         <span class="st">"cm2"</span><span class="op">)</span>,</span>
<span>              volume   <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Volume"</span>,       <span class="st">"cm3"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ft</span> <span class="op">=</span> <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/flextable.html" class="external-link">flextable</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span>                     <span class="op">%&gt;%</span> </span>
<span>     <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/delete_part.html" class="external-link">delete_part</a></span><span class="op">(</span>part <span class="op">=</span> <span class="st">"header"</span><span class="op">)</span>        <span class="op">%&gt;%</span></span>
<span>     <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/add_header.html" class="external-link">add_header</a></span><span class="op">(</span>values <span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">as.list</a></span><span class="op">(</span><span class="va">header</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>     <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/theme_zebra.html" class="external-link">theme_zebra</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>That flextable currently looks like this:</p>
<style></style>
<div class="tabwid">
<style>.cl-afb300ce{}.cl-afafff6e{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-afafff78{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-afb134d8{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-afb134d9{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-afb1409a{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afb1409b{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afb140a4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afb140a5{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afb140a6{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afb140a7{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afb140ae{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afb140af{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="table cl-afb300ce">
<thead>
<tr style="overflow-wrap:break-word;">
<th class="cl-afb1409a"><p class="cl-afb134d8"><span class="cl-afafff6e"></span></p></th>
<th class="cl-afb1409b"><p class="cl-afb134d9"><span class="cl-afafff6e">Length</span></p></th>
<th class="cl-afb1409b"><p class="cl-afb134d9"><span class="cl-afafff6e">Wdith</span></p></th>
<th class="cl-afb1409b"><p class="cl-afb134d9"><span class="cl-afafff6e">Area</span></p></th>
<th class="cl-afb1409b"><p class="cl-afb134d9"><span class="cl-afafff6e">Volume</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-afb140a4"><p class="cl-afb134d8"><span class="cl-afafff6e"></span></p></th>
<th class="cl-afb140a5"><p class="cl-afb134d9"><span class="cl-afafff6e">cm</span></p></th>
<th class="cl-afb140a5"><p class="cl-afb134d9"><span class="cl-afafff6e">cm</span></p></th>
<th class="cl-afb140a5"><p class="cl-afb134d9"><span class="cl-afafff6e">cm2</span></p></th>
<th class="cl-afb140a5"><p class="cl-afb134d9"><span class="cl-afafff6e">cm3</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-afb140a6"><p class="cl-afb134d8"><span class="cl-afafff78">mean</span></p></td>
<td class="cl-afb140a7"><p class="cl-afb134d9"><span class="cl-afafff78">200.00</span></p></td>
<td class="cl-afb140a7"><p class="cl-afb134d9"><span class="cl-afafff78">12.00</span></p></td>
<td class="cl-afb140a7"><p class="cl-afb134d9"><span class="cl-afafff78">240.00</span></p></td>
<td class="cl-afb140a7"><p class="cl-afb134d9"><span class="cl-afafff78">1,200.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-afb140ae"><p class="cl-afb134d8"><span class="cl-afafff78">variance</span></p></td>
<td class="cl-afb140af"><p class="cl-afb134d9"><span class="cl-afafff78">0.13</span></p></td>
<td class="cl-afb140af"><p class="cl-afb134d9"><span class="cl-afafff78">0.05</span></p></td>
<td class="cl-afb140af"><p class="cl-afb134d9"><span class="cl-afafff78">0.11</span></p></td>
<td class="cl-afb140af"><p class="cl-afb134d9"><span class="cl-afafff78">0.32</span></p></td>
</tr>
</tbody>
</table>
</div>
<p>Now, lets customize some things. For example, suppose we want to use
exponents on the units and represent the mean and variance with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>Î¼</mi><annotation encoding="application/x-tex">\mu</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msup><mi>Ïƒ</mi><mn>2</mn></msup><annotation encoding="application/x-tex">\sigma^2</annotation></semantics></math>.</p>
<p>First, we need to create lists with the default value for the table
labels (i.e.Â the header) and the table body. The markdown will create
deviations from these defaults. You can look at the help for
<code><a href="../reference/md_to_oo.html">onbrand::md_to_oo</a></code> to get the appropriate list format. Here
weâ€™re just pulling them out of the <code>onbrand</code> object using
<code><a href="../reference/fetch_md_def.html">onbrand::fetch_md_def()</a></code>.</p>
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dft</span>      <span class="op">=</span> <span class="fu"><a href="../reference/fetch_md_def.html">fetch_md_def</a></span><span class="op">(</span><span class="va">obnd</span>, style<span class="op">=</span><span class="st">"Table_Labels"</span><span class="op">)</span><span class="op">$</span><span class="va">md_def</span></span>
<span><span class="va">dft_body</span> <span class="op">=</span> <span class="fu"><a href="../reference/fetch_md_def.html">fetch_md_def</a></span><span class="op">(</span><span class="va">obnd</span>, style<span class="op">=</span><span class="st">"Table"</span><span class="op">)</span><span class="op">$</span><span class="va">md_def</span></span></code></pre></div>
<p>Now we can use the <code><a href="https://davidgohel.github.io/flextable/reference/compose.html" class="external-link">flextable::compose</a></code> function to walk
through the table and overwrite the defaults that were set when the
flextable was created:</p>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ft</span> <span class="op">=</span> <span class="va">ft</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/compose.html" class="external-link">compose</a></span><span class="op">(</span>j     <span class="op">=</span> <span class="st">"area"</span>,</span>
<span>          part  <span class="op">=</span> <span class="st">"header"</span>, </span>
<span>          value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"Area"</span>, <span class="va">dft</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span>, <span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"cm^2^"</span>, <span class="va">dft</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span><span class="op">)</span><span class="op">)</span>   <span class="op">%&gt;%</span></span>
<span>  <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/compose.html" class="external-link">compose</a></span><span class="op">(</span>j     <span class="op">=</span> <span class="st">"volume"</span>, </span>
<span>          part  <span class="op">=</span> <span class="st">"header"</span>,</span>
<span>          value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"Volume"</span>, <span class="va">dft</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span>, <span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"cm^3^"</span>, <span class="va">dft</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span></span>
<span>  <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/compose.html" class="external-link">compose</a></span><span class="op">(</span>j     <span class="op">=</span> <span class="st">"property"</span>, </span>
<span>          i     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="st">"mean"</span>, <span class="va">data</span><span class="op">$</span><span class="va">property</span><span class="op">)</span>,                        </span>
<span>          part  <span class="op">=</span> <span class="st">"body"</span>,  </span>
<span>          value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"**&lt;ff:symbol&gt;m&lt;/ff&gt;**"</span>, <span class="va">dft_body</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span><span class="op">)</span><span class="op">)</span>    <span class="op">%&gt;%</span></span>
<span>  <span class="fu">flextable</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/flextable/reference/compose.html" class="external-link">compose</a></span><span class="op">(</span>j     <span class="op">=</span> <span class="st">"property"</span>,</span>
<span>          i     <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/match.html" class="external-link">match</a></span><span class="op">(</span><span class="st">"variance"</span>, <span class="va">data</span><span class="op">$</span><span class="va">property</span><span class="op">)</span>, </span>
<span>          part  <span class="op">=</span> <span class="st">"body"</span>,                                                     </span>
<span>          value <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/md_to_oo.html">md_to_oo</a></span><span class="op">(</span><span class="st">"**&lt;ff:symbol&gt;s&lt;/ff&gt;**^**2**^"</span>, <span class="va">dft_body</span><span class="op">)</span><span class="op">$</span><span class="va">oo</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Now the flextable object looks like this:</p>
<style></style>
<div class="tabwid">
<style>.cl-afd13d3c{}.cl-afce676a{font-family:'Helvetica';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-afce6774{font-family:'Helvetica';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-afce6775{font-family:'Helvetica';font-size:7.2pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;position: relative;bottom:3.6pt;}.cl-afce677e{font-family:'symbol';font-size:12pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-afce677f{font-family:'Helvetica';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-afcf9022{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-afcf902c{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-afcf9ba8{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afcf9bb2{width:0.75in;background-color:rgba(207, 207, 207, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afcf9bb3{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afcf9bb4{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afcf9bbc{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afcf9bbd{width:0.75in;background-color:rgba(239, 239, 239, 1.00);vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afcf9bbe{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-afcf9bc6{width:0.75in;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style>
<table data-quarto-disable-processing="true" class="table cl-afd13d3c">
<thead>
<tr style="overflow-wrap:break-word;">
<th class="cl-afcf9ba8"><p class="cl-afcf9022"><span class="cl-afce676a"></span></p></th>
<th class="cl-afcf9bb2"><p class="cl-afcf902c"><span class="cl-afce676a">Length</span></p></th>
<th class="cl-afcf9bb2"><p class="cl-afcf902c"><span class="cl-afce676a">Wdith</span></p></th>
<th class="cl-afcf9bb2"><p class="cl-afcf902c"><span class="cl-afce6774">Area</span></p></th>
<th class="cl-afcf9bb2"><p class="cl-afcf902c"><span class="cl-afce6774">Volume</span></p></th>
</tr>
<tr style="overflow-wrap:break-word;">
<th class="cl-afcf9bb3"><p class="cl-afcf9022"><span class="cl-afce676a"></span></p></th>
<th class="cl-afcf9bb4"><p class="cl-afcf902c"><span class="cl-afce676a">cm</span></p></th>
<th class="cl-afcf9bb4"><p class="cl-afcf902c"><span class="cl-afce676a">cm</span></p></th>
<th class="cl-afcf9bb4"><p class="cl-afcf902c"><span class="cl-afce6774">cm</span><span class="cl-afce6775">2</span></p></th>
<th class="cl-afcf9bb4"><p class="cl-afcf902c"><span class="cl-afce6774">cm</span><span class="cl-afce6775">3</span></p></th>
</tr>
</thead>
<tbody>
<tr style="overflow-wrap:break-word;">
<td class="cl-afcf9bbc"><p class="cl-afcf9022"><span class="cl-afce677e">m</span></p></td>
<td class="cl-afcf9bbd"><p class="cl-afcf902c"><span class="cl-afce677f">200.00</span></p></td>
<td class="cl-afcf9bbd"><p class="cl-afcf902c"><span class="cl-afce677f">12.00</span></p></td>
<td class="cl-afcf9bbd"><p class="cl-afcf902c"><span class="cl-afce677f">240.00</span></p></td>
<td class="cl-afcf9bbd"><p class="cl-afcf902c"><span class="cl-afce677f">1,200.00</span></p></td>
</tr>
<tr style="overflow-wrap:break-word;">
<td class="cl-afcf9bbe"><p class="cl-afcf9022"><span class="cl-afce677e">s</span><span class="cl-afce6775">2</span></p></td>
<td class="cl-afcf9bc6"><p class="cl-afcf902c"><span class="cl-afce677f">0.13</span></p></td>
<td class="cl-afcf9bc6"><p class="cl-afcf902c"><span class="cl-afce677f">0.05</span></p></td>
<td class="cl-afcf9bc6"><p class="cl-afcf902c"><span class="cl-afce677f">0.11</span></p></td>
<td class="cl-afcf9bc6"><p class="cl-afcf902c"><span class="cl-afce677f">0.32</span></p></td>
</tr>
</tbody>
</table>
</div>
<p><strong>Note that the Greek symbols are not rendered correctly here
but will be rendered correctly in the document.</strong></p>
<p>To include the newly formatted table in the <code>onbrand</code>
object, you use the same method as before:</p>
<div class="sourceCode" id="cb51"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">obnd</span> <span class="op">=</span> <span class="fu"><a href="../reference/report_add_doc_content.html">report_add_doc_content</a></span><span class="op">(</span><span class="va">obnd</span>,</span>
<span>  type     <span class="op">=</span> <span class="st">"flextable_object"</span>,</span>
<span>  content  <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>ft<span class="op">=</span><span class="va">tab_fto</span>,</span>
<span>                  caption  <span class="op">=</span> <span class="st">"Flextable object with custom Markdown - created by the user."</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="accessing-the-officer-object-directly">Accessing the <code>officer</code> object directly<a class="anchor" aria-label="anchor" href="#accessing-the-officer-object-directly"></a>
</h3>
<p>Sometimes you need more control over creating a report, and you may
want to use the officer commands directly. To do this you can use the
function <code><a href="../reference/fetch_officer_object.html">fetch_officer_object()</a></code> to pull out the officer
object from the <code>onbrand</code> object:</p>
<p>Now you can use any officer command you wish on the <code>rpt</code>
object. And when youâ€™re done you can put the object back into the
<code>onbrand</code> object using <code><a href="../reference/set_officer_object.html">set_officer_object()</a></code>:</p>
</div>
<div class="section level3">
<h3 id="mapping-file">Mapping file<a class="anchor" aria-label="anchor" href="#mapping-file"></a>
</h3>
<pre><code>rpptx:
  master: Office Theme
  templates:
    title_slide:
      title:
        ph_label:     Title 1
        content_type: text
      sub_title:
        ph_label:     Subtitle 2
        content_type: text
    section_slide:
      title:
        ph_label:     Title 1
        content_type: text
      sub_title:
        ph_label:     Subtitle 2
        content_type: text
    title_only:
      title:
        ph_label:     Title 1
        content_type: text
    content_text:
      title:
        ph_label:     Title 1
        content_type: text
      sub_title:
        ph_label:     Subtitle 2
        content_type: text
      content_body:
        ph_label:     Content Placeholder 2
        content_type: text
    content_list:
      title:
        ph_label:     Title 1
        content_type: text
      sub_title:
        ph_label:     Subtitle 2 
        content_type: text
      content_body:
        ph_label:     Content Placeholder 2
        content_type: list
    two_content_header_list:
      title:
        ph_label:     Title 1
        content_type: text
      sub_title:
        ph_label:     Subtitle 2
        content_type: text
      content_left_header:
        ph_label:     Text Placeholder 2
        content_type: text
      content_left:
        ph_label:     Content Placeholder 3
        content_type: list
      content_right_header:
        ph_label:     Text Placeholder 4
        content_type: text
      content_right:
        ph_label:     Content Placeholder 5
        content_type: list
    two_content_header_text:
      title:
        ph_label:     Title 1
        content_type: text
      sub_title:
        ph_label:     Subtitle 2 
        content_type: text
      content_left_header:
        ph_label:     Text Placeholder 2
        content_type: text
      content_left:
        ph_label:     Content Placeholder 3
        content_type: text
      content_right_header:
        ph_label:     Text Placeholder 4
        content_type: text
      content_right:
        ph_label:     Content Placeholder 5
        content_type: text
    two_content_list:
      title:
        ph_label:     Title 1
        content_type: text
      sub_title:
        ph_label:     Subtitle 2 
        content_type: text
      content_left:
        ph_label:     Content Placeholder 2
        content_type: list
      content_right:
        ph_label:     Content Placeholder 3
        content_type: list
    two_content_text:
      title:
        ph_label:     Title 1
        content_type: text
      sub_title:
        ph_label:     Subtitle 2 
        content_type: text
      content_left:
        ph_label:     Content Placeholder 2
        content_type: text
      content_right:
        ph_label:     Content Placeholder 3
        content_type: text
  md_def:
    default:
      color:                 black
      font.size:             12
      bold:                  TRUE
      italic:                FALSE
      underlined:            FALSE
      font.family:           Helvetica
      vertical.align:        baseline
      shading.color:         transparent
    Table_Labels:
      color:                 black
      font.size:             12
      bold:                  TRUE
      italic:                FALSE
      underlined:            FALSE
      font.family:           Helvetica
      vertical.align:        baseline
      shading.color:         transparent
  post_processing:           NULL
rdocx:
  styles:
    Normal:                    Normal
    Notes:                     Notes
    Code:                      Code
    TOC:                       toc 1
    Heading_1:                 heading 1
    Heading_2:                 heading 2
    Heading_3:                 heading 3
    Table:                     Table Grid
    Table_Caption:             table title
    Figure_Caption:            graphic title
  doc_def:
    Text:                      Normal
    Table:                     Table
    Table_Caption:             Table_Caption
    Figure_Caption:            Figure_Caption
    Notes:                     Notes
  formatting:
    separator:                 ","
    Table_Order:
      - table
      - notes
      - caption
    Table_Caption_Label_Pre:   "Table "
    Table_Caption_Label_Post:  ". "
    Figure_Order:
      - figure
      - notes
      - caption
    Figure_Caption_Label_Pre:  "Figure "
    Figure_Caption_Label_Post: ". "
    Figure_Width:              6.0
    Figure_Height:             5.0
    Figure_Seq_Id:             "Figure"
    Figure_Number: |-
      list(officer::run_autonum(pre_label  = "", 
                                seq_id     = Caption_Seq_Id, 
                                post_label = "", 
                                start_at   = Caption_Start_At))
    Table_Seq_Id:              "Table"
    Table_Number: |-
      list(officer::run_autonum(pre_label  = "", 
                                seq_id     = Caption_Seq_Id, 
                                post_label = "", 
                                start_at   = Caption_Start_At))
  md_def:
    # For each style above you need a default specification here. You will
    # also need the 'default' specification, generally just a copy of Normal
    default:
      color:                  black
      font.size:              12
      bold:                   FALSE
      italic:                 FALSE
      underlined:             FALSE
      font.family:            Cambria (Body)
      vertical.align:         baseline
      shading.color:          transparent
    Table_Labels:
      color:                 black
      font.size:             12
      bold:                  TRUE
      italic:                FALSE
      underlined:            FALSE
      font.family:           Helvetica
      vertical.align:        baseline
      shading.color:         transparent
    Notes:
      color:                  black
      font.size:              10
      bold:                   FALSE
      italic:                 FALSE
      underlined:             FALSE
      font.family:            Cambria (Body)
      vertical.align:         baseline
      shading.color:          transparent
    Normal:
      color:                  black
      font.size:              12
      bold:                   FALSE
      italic:                 FALSE
      underlined:             FALSE
      font.family:            Cambria (Body)
      vertical.align:         baseline
      shading.color:          transparent
    Code:
      color:                  black
      font.size:              12
      bold:                   FALSE
      italic:                 FALSE
      underlined:             FALSE
      font.family:            Courier
      vertical.align:         baseline
      shading.color:          transparent
    TOC:
      color:                  black
      font.size:              12
      bold:                   FALSE
      italic:                 FALSE
      underlined:             FALSE
      font.family:            Courier
      vertical.align:         baseline
      shading.color:          transparent
    Heading_1:
      color:                  black
      font.size:              16
      bold:                   TRUE
      italic:                 FALSE
      underlined:             FALSE
      font.family:            Calibri (Headings)
      vertical.align:         baseline
      shading.color:          transparent
    Heading_2:
      color:                  black
      font.size:              13
      bold:                   TRUE
      italic:                 FALSE
      underlined:             FALSE
      font.family:            Calibri (Headings)
      vertical.align:         baseline
      shading.color:          transparent
    Heading_3:
      color:                  black
      font.size:              12
      bold:                   TRUE
      italic:                 FALSE
      underlined:             FALSE
      font.family:            Calibri (Headings)
      vertical.align:         baseline
      shading.color:          transparent
    Table:
      color:                 black
      font.size:             12
      bold:                  FALSE
      italic:                FALSE
      underlined:            FALSE
      font.family:           Helvetica
      vertical.align:        baseline
      shading.color:         transparent
    Table_Caption:
      color:                 black
      font.size:             12
      bold:                  TRUE
      italic:                TRUE
      underlined:            FALSE
      font.family:           Cambria (Body)
      vertical.align:        baseline
      shading.color:         transparent
    Figure_Caption:
      color:                 black
      font.size:             12
      bold:                  TRUE
      italic:                TRUE
      underlined:            FALSE
      font.family:           Cambria (Body)
      vertical.align:        baseline
      shading.color:         transparent
  post_processing:           NULL  </code></pre>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Harrold, Bryan Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
