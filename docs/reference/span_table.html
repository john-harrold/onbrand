<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Spread Large Table Over Smaller Tables — span_table • onbrand</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Spread Large Table Over Smaller Tables — span_table"><meta name="description" content="Takes a large table and spreads it over smaller tables to
paginate it. It will preserve common row  information on the left and
separate columns according to maximum specifications. The final tables will
have widths less than or equal to both max_col and max_width, and heights
less than or equal to both max_row and max_height."><meta property="og:description" content="Takes a large table and spreads it over smaller tables to
paginate it. It will preserve common row  information on the left and
separate columns according to maximum specifications. The final tables will
have widths less than or equal to both max_col and max_width, and heights
less than or equal to both max_row and max_height."><meta property="og:image" content="https:://onbrand.ubiquity.tools/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">onbrand</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-tutorials" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fas fa-chalkboard-teacher"></span> Tutorials</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-tutorials"><li><hr class="dropdown-divider"></li>
    <li><a class="dropdown-item" href="../articles/Custom_Office_Templates.html">Custom Office Templates</a></li>
    <li><a class="dropdown-item" href="../articles/Creating_Templated_Office_Workflows.html">Templated Reporting Workflows in PowerPoint and Word</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fas fa-hat-wizard"></span> Functions</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html"><span class="fa fas fa-rss"></span> News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/john-harrold/onbrand/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Spread Large Table Over Smaller Tables</h1>
      <small class="dont-index">Source: <a href="https://github.com/john-harrold/onbrand/blob/HEAD/R/span_table.R" class="external-link"><code>R/span_table.R</code></a></small>
      <div class="d-none name"><code>span_table.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Takes a large table and spreads it over smaller tables to
paginate it. It will preserve common row  information on the left and
separate columns according to maximum specifications. The final tables will
have widths less than or equal to both max_col and max_width, and heights
less than or equal to both max_row and max_height.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">span_table</span><span class="op">(</span></span>
<span>  table_body <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_common <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  table_body_head <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  row_common_head <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  header_format <span class="op">=</span> <span class="st">"text"</span>,</span>
<span>  obnd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_row <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  max_col <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_height <span class="op">=</span> <span class="fl">7</span>,</span>
<span>  max_width <span class="op">=</span> <span class="fl">6.5</span>,</span>
<span>  table_alignment <span class="op">=</span> <span class="st">"center"</span>,</span>
<span>  inner_border <span class="op">=</span> <span class="fu">officer</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/fp_border.html" class="external-link">fp_border</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>,</span>
<span>  outer_border <span class="op">=</span> <span class="fu">officer</span><span class="fu">::</span><span class="fu"><a href="https://davidgohel.github.io/officer/reference/fp_border.html" class="external-link">fp_border</a></span><span class="op">(</span>color <span class="op">=</span> <span class="st">"black"</span>, width <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>,</span>
<span>  set_header_inner_border_v <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  set_header_inner_border_h <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  set_header_outer_border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  set_body_inner_border_v <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  set_body_inner_border_h <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  set_body_outer_border <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  notes_detect <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-table-body">table_body<a class="anchor" aria-label="anchor" href="#arg-table-body"></a></dt>
<dd><p>Data frame with the body of the large table.</p></dd>


<dt id="arg-row-common">row_common<a class="anchor" aria-label="anchor" href="#arg-row-common"></a></dt>
<dd><p>Data frame with the common rows.</p></dd>


<dt id="arg-table-body-head">table_body_head<a class="anchor" aria-label="anchor" href="#arg-table-body-head"></a></dt>
<dd><p>Data frame or matrix with headers for the table body.</p></dd>


<dt id="arg-row-common-head">row_common_head<a class="anchor" aria-label="anchor" href="#arg-row-common-head"></a></dt>
<dd><p>Data frame or matrix with headers for the common rows.</p></dd>


<dt id="arg-header-format">header_format<a class="anchor" aria-label="anchor" href="#arg-header-format"></a></dt>
<dd><p>Format of the header either <code>"text"</code> (default) or <code>"md"</code> for markdown.</p></dd>


<dt id="arg-obnd">obnd<a class="anchor" aria-label="anchor" href="#arg-obnd"></a></dt>
<dd><p>Optional onbrand object used to format markdown. The default <code>NULL</code> value will use default formatting.</p></dd>


<dt id="arg-max-row">max_row<a class="anchor" aria-label="anchor" href="#arg-max-row"></a></dt>
<dd><p>Maximum number of rows in output tables (A value of <code>NULL</code> will set max_row to the number of rows in the table).</p></dd>


<dt id="arg-max-col">max_col<a class="anchor" aria-label="anchor" href="#arg-max-col"></a></dt>
<dd><p>Maximum number of columns in output tables (A value of <code>NULL</code> will set max_col to number of columns in the table).</p></dd>


<dt id="arg-max-height">max_height<a class="anchor" aria-label="anchor" href="#arg-max-height"></a></dt>
<dd><p>Maximum height of the final table in inches (A value of <code>NULL</code> will use 100 inches).</p></dd>


<dt id="arg-max-width">max_width<a class="anchor" aria-label="anchor" href="#arg-max-width"></a></dt>
<dd><p>Maximum width of the final table in inches (A value of <code>NULL</code> will use 100 inches).</p></dd>


<dt id="arg-table-alignment">table_alignment<a class="anchor" aria-label="anchor" href="#arg-table-alignment"></a></dt>
<dd><p>Character string specifying the alignment #'of the table (body and headers). Can be <code>"center"</code> (default), <code>"left"</code>, <code>"right"</code>, or <code>"justify"</code></p></dd>


<dt id="arg-inner-border">inner_border<a class="anchor" aria-label="anchor" href="#arg-inner-border"></a></dt>
<dd><p>Border object for inner border lines defined using <code><a href="https://davidgohel.github.io/officer/reference/fp_border.html" class="external-link">officer::fp_border()</a></code></p></dd>


<dt id="arg-outer-border">outer_border<a class="anchor" aria-label="anchor" href="#arg-outer-border"></a></dt>
<dd><p>Border object for outer border lines defined using <code><a href="https://davidgohel.github.io/officer/reference/fp_border.html" class="external-link">officer::fp_border()</a></code></p></dd>


<dt id="arg-set-header-inner-border-v">set_header_inner_border_v<a class="anchor" aria-label="anchor" href="#arg-set-header-inner-border-v"></a></dt>
<dd><p>Boolean value to enable or disable inner vertical borders for headers</p></dd>


<dt id="arg-set-header-inner-border-h">set_header_inner_border_h<a class="anchor" aria-label="anchor" href="#arg-set-header-inner-border-h"></a></dt>
<dd><p>Boolean value to enable or disable inner horizontal borders for headers</p></dd>


<dt id="arg-set-header-outer-border">set_header_outer_border<a class="anchor" aria-label="anchor" href="#arg-set-header-outer-border"></a></dt>
<dd><p>Boolean value to enable or disable outer border for headers</p></dd>


<dt id="arg-set-body-inner-border-v">set_body_inner_border_v<a class="anchor" aria-label="anchor" href="#arg-set-body-inner-border-v"></a></dt>
<dd><p>Boolean value to enable or disable inner vertical borders for the body</p></dd>


<dt id="arg-set-body-inner-border-h">set_body_inner_border_h<a class="anchor" aria-label="anchor" href="#arg-set-body-inner-border-h"></a></dt>
<dd><p>Boolean value to enable or disable inner horizontal borders for the body</p></dd>


<dt id="arg-set-body-outer-border">set_body_outer_border<a class="anchor" aria-label="anchor" href="#arg-set-body-outer-border"></a></dt>
<dd><p>Boolean value to enable or disable outer border borders for the body</p></dd>


<dt id="arg-notes-detect">notes_detect<a class="anchor" aria-label="anchor" href="#arg-notes-detect"></a></dt>
<dd><p>Vector of strings to detect in output tables (example <code>c("NC", "BLQ")</code>).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>list with the following elements</p><ul><li><p>isgood:    Boolean indicating the exit status of the function.</p></li>
<li><p>one_body:  Full table with no headers.</p></li>
<li><p>one_table: Full table with headers.</p></li>
<li><p>msgs:      Vector of text messages describing any errors that were found.</p></li>
<li><p>tables:    Named list of tables. Each list element is of the output.
  format from <code><a href="build_span.html">build_span()</a></code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The way the data frames relate to each other are mapped out below. The
dimensions of the different data frames are identified below (nrow x ncol)</p>
<div class="sourceCode"><pre><code>
 |-------------------------------------| ---
 |                 |                   |  ^
 |                 |                   |  |
 | row_common_head |  table_body_head  |  | m
 |      m x n      |       m x c       |  |
 |                 |                   |  v
 |-------------------------------------| ---
 |                 |                   |  ^
 |                 |                   |  |
 |    row_common   |    table_body     |  | r
 |      r x n      |      r x c        |  |
 |                 |                   |  |
 |                 |                   |  v
 |-------------------------------------| ---

 |&lt;---------------&gt;|&lt;-----------------&gt;|
         n                   c
</code></pre></div>

    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="build_span.html">build_span</a> for the relationship of inputs.</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/interactive.html" class="external-link">interactive</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">tbl_res</span> <span class="op">=</span> <span class="fu"><a href="mk_lg_tbl.html">mk_lg_tbl</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span></span></span>
<span class="r-in"><span><span class="fu">span_table</span><span class="op">(</span>table_body      <span class="op">=</span> <span class="va">tbl_res</span><span class="op">$</span><span class="va">lg_tbl_body</span>,</span></span>
<span class="r-in"><span>           row_common      <span class="op">=</span> <span class="va">tbl_res</span><span class="op">$</span><span class="va">lg_tbl_row_common</span>,</span></span>
<span class="r-in"><span>           table_body_head <span class="op">=</span> <span class="va">tbl_res</span><span class="op">$</span><span class="va">lg_tbl_body_head</span>,</span></span>
<span class="r-in"><span>           row_common_head <span class="op">=</span> <span class="va">tbl_res</span><span class="op">$</span><span class="va">lg_tbl_row_common_head</span>,</span></span>
<span class="r-in"><span>           max_row         <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>           max_col         <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>           notes_detect    <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"BQL"</span>, <span class="st">"NC"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Notes detected in the first table:</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">[[</span><span class="st">"tables"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Table 1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"notes"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># First table as a data frame:</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">[[</span><span class="st">"tables"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Table 1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"df"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># First table as a flextable:</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">[[</span><span class="st">"tables"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"Table 1"</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="st">"ft"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by John Harrold, Bryan Smith.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

